% HEADERS
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\documentclass[11pt,a4paper]{report}
%\usepackage[italian]{babel}
\usepackage{graphicx}
\usepackage{wrapfig}
\usepackage{verbatim}
\usepackage{listings}
\usepackage{xcolor}
\usepackage{hyperref}
\usepackage{float}
\usepackage{titlesec}
\usepackage{nomencl}
\usepackage{amsmath}
\usepackage{epsfig}
\usepackage{wasysym}
\usepackage{gensymb} 
%\psdraft
\makenomenclature
\usepackage{marginnote}

\renewcommand{\vec}[1]{\mathbf{#1}}
\let\oldhat\hat
\renewcommand{\hat}[1]{\oldhat{\mathbf{#1}}}

\titleformat{\part}[display]
  {\Huge\bfseries}
  {}
  {0pt}
  {}

\titleformat{\chapter}[display]
 {\huge\bfseries}
 {}
 {0pt}
 {}

 \titleformat{\section}[display]
 {\Large\bfseries}
 {}
 {0pt}
 {\thesection\  \ }

\def\UrlBreaks{\do\/\do-}
\hypersetup{
    colorlinks=true,
    linkcolor=black,
    filecolor=magenta,
    urlcolor=cyan,
}
%\usepackage{url}
\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{backcolour}{rgb}{0.95,0.95,0.92}

\lstdefinestyle{mystyle}{
    backgroundcolor=\color{backcolour},
    commentstyle=\color{codegreen},
    keywordstyle=\color{magenta},
    numberstyle=\tiny\color{codegray},
    stringstyle=\color{codepurple},
    basicstyle=\ttfamily\footnotesize,
    breakatwhitespace=false,
    breaklines=true,
    captionpos=b,
    keepspaces=true,
    numbers=left,
    numbersep=5pt,
    showspaces=false,
    showstringspaces=false,
    showtabs=false,
    tabsize=2
}

\graphicspath{ {images/} }
\title{Orbital Mechanics Project}

\author{Marwan Alkady\\ Pedro Bossi N\'{u}\~{n}ez \\\ Demartini Davide\\ Iafrate Davide\\}
\date{\today}
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% ACTUAL DOCUMENT

\begin{document}

% FRONT COVER AND TABLE OF CONTENTS
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{titlepage}
	\clearpage\thispagestyle{empty}
	\centering

%	Titles
%	Information about the University

   \centering \includegraphics[scale=0.7]{logo}

   \vspace{0.5cm}

	{\Huge\textbf{Politecnico di Milano} \\
Master of Science in\\ Space Engineering \\
		 \par}
		\vspace{3cm}
	{\Huge{Orbital Mechanics Project}} \\
	%\vspace{1cm}
	%{\large \textbf{xxxxx} \par}
	\vspace{3cm}
	{\huge Group 33\\}
	\vspace{0.4cm}
	{\LARGE Marwan Alkady 88888 - 88888888\\ Pedro Bossi N\'{u}\~{n}ez 887651 - 10561223\\ Davide Demartini 888657 - 10574461\\ Davide Iafrate 967709 - 10800009\\ \par}

%	Set the date
\vspace{1cm}
	{\Large A.Y. 2020-2021 \par}

	\pagebreak

\end{titlepage}

%\maketitle
\nomenclature{$a$}{semi-major axis}
\nomenclature{$e$}{eccentricity}
\nomenclature{$i$}{inclination}
\nomenclature{$\omega$}{periapsis anomaly}
\nomenclature{$\Omega$}{Right ascension of the ascending node}
\nomenclature{$f$}{true anomaly}
\nomenclature{h}{specific angular momentum per unit mass}
\nomenclature{$r$}{radius}
\nomenclature{AU}{Astronomical Unit (1.495978707×10^8 km)}
\nomenclature{$\mu_{\oplus}$}{Gravitational Parameter of Earth}
\nomenclature{$\mu_{\astrosun}$}{Gravitational Parameter of the Sun}

\printnomenclature
\tableofcontents

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% TEXT
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\part{Assignment 1: Interplanetary Explorer Mission}

\chapter{Mission requirements}
In this report different transfer strategies between the planets Neptune and Mercury are analysed.
Such strategies are constrained by two time limits: earliest departure from Neptune $1^{st}$ January 2031 and latest arrival at Mercury $1^{st}$ February 2071. Furthermore, they must include a flyby of the planet Venus.
Once possible transfers are identified, the least expensive in terms of  required is selected.
% table with:
% Departure Planet
% flyby planet
% arrival planet
% minimum departure and maximum arrival dates

\chapter{Mission analysis outputs}

\section{Design process}

\subsection{Initial choice for the time windows}

\subsection{Additional constraints considered}

\subsection{Transfer options exploration, analysis and comparison}

\subsection{Selection of the final solution}
% with plots and stuff

\section{Final solution}

\subsection{Heliocentric trajectory}
(The transfer is studied by placing the system of reference at the centre of the Sun.)
The final transfer strategy is composed of four arcs: the first and the last one lie inside the Sun’s sphere of influence; the second and third one are inside Venus’ sphere of influence (and are analysed in a later paragraph). The transfer is executed between the times 00:00:36 on 01/02/2031 (dd/mm/yyyy) and 12:43:52 on 05/07/2057. The powered flyby is performed at 08:29:31 on 02/07/2050.
Figure with complete strategy
The first arc connects Neptune and Venus orbits. It is characterised by the following data:

\begin{table}[H]
\centering
\resizebox{\textwidth}{!}{%
\begin{tabular}{|c|c|c|c|c|}
\hline
\textbf{a [km]} & \textbf{e [-]} & \textbf{i [rad]} & \textbf{$\Omega [rad]$} & \textbf{[rad]} \\ \hline
$2.7167 \cdot 10^9$       & 0.9738         & 0.0267           & 1.7574              & 1.4913         \\ \hline
\end{tabular}%
}
%\caption{}
%\label{tab:my-table}
\end{table}

The initial position is characterised by a true anomaly (f) of 3.2451 rad (, which means that the probe enters its orbit around the sun after the aphelion). In Cartesian coordinates the initial point is identified by the following data:

\begin{table}[H]
\centering
\resizebox{0.75\textwidth}{!}{%
\begin{tabular}{|c|c|c|}
\hline
\textbf{R$_x$ [km]}   & \textbf{R$_y$ [km]}   & \textbf{R$_z$ [km]}   \\ \hline
$43.712 \cdot 10^8$   & $9.348 \cdot 10^8$    & $-1.193 \cdot 10^8$   \\ \hline
\textbf{v$_x$ [km/s]} & \textbf{v$_y$ [km/s]} & \textbf{v$_z$ [km/s]} \\ \hline
-3.2267               & 0.2969                & 0.0832                \\ \hline
\end{tabular}%
}
%\caption{}
%\label{tab:my-table}
\end{table}

The initial position’s distance from the Sun is 4.4716$\cdot 10^8$ km and the velocity at the initial point is 3.2414 km/s.
The fourth arc connects the point where the spacecraft exits the Venus’ sphere of influence with Mercury.
% Departure, flyby and arrival times.
% Plot of the heliocentric trajectory,together with the orbits of
% the three planets and their positions at departure, flyby and arrival.

\subsection{Powered gravity assist}
% Altitude of the closest approach.
% Time duration of the flyby (considering a finite SOI).
% Compare total flyby \Delta v with the cost of the manoeuvre \Delta v_{ga}
% Plot of the incoming and outcoming hyperbola arcs

\subsection{Cost of the mission}
%\Delta v_{dep}, \Delta v_{ga}, \Delta v_{arr}.

\part{Assignment 2: Planetary Explorer Mission}

\chapter{Mission requirements}
In this chapter we are going to explain how we have designed a planetary explorer
mission to perform Earth observation: we were in fact required to analyse the Earth-centred orbit characterised by the values in the table below and estimate its ground track, studying the effects of the assigned orbit perturbations by integrating both Gauß’s planetary equations and Cartesian equations and subsequently comparing the results of the two methods. After the characterisation of the ground track, we propose a modification of the orbit aimed to get a ground track which repeats itself once a sidereal day.\\

\begin{table}[H]
\centering
\resizebox{\textwidth}{!}{%
\begin{tabular}{|c|c|c|c|}
\hline
\textbf{a} [$10^4 km$]                                                       & \textbf{e}             & \textbf{i} [deg]   & \textbf{hp} [km]             \\ \hline
4.0718                                                            & 0.6177        & 78.2195   & 15566.491           \\ \hline
\begin{tabular}[c]{@{}c@{}}\textbf{Repeating GT} \\ \textbf{ratio k:m$^{note}$}\end{tabular} & \textbf{Perturbations} & \multicolumn{2}{c|}{\textbf{Parameters}} \\ \hline
1:1                                                               & J2 and SRP    & cR = 1.2  & A/m = 4.000 $m^2/kg$  \\ \hline
\end{tabular}%
}
\caption{Mission requirements}
\label{tab:Mission_requirements}
\end{table}

\marginnote{\textbf{Note}: the grountrack repeats itself \textbf{k} times every \textbf{m} revolutions of the planet.}[-4cm]

\chapter{Mission analysis outputs}

\section{Nominal orbit}
%initial values and main characteristics

\section{Ground track}
% GT considering only J2 as perturbation and GT considering the assigned perturbation

\section{Orbit Perturbations}
In our model we included perturbations due to two effects:
\begin{itemize}
    \item \textbf{Second Zonal Harmonic \emph{J2}} \par Models the Earth Oblateness using the spherical geopotentials model, truncated to the second term.
    \item \textbf{Solar Radiation Pressure \emph{SRP}} \par A force given by the impact of momentum-carrying photons on the surfaces of the spacecraft. For this perturbation we have written a function that, based on the initial date gets the position vector of the Earth from the ephemerides function and uses that together with the position vector of the spacecraft with respect to the Earth to calculate the direction of the disturbing acceleration. A simple algorithm for the eclipse condition found in \cite{SRP_Curtis} has been implemented.
    \begin{equation}
        \vec{a_{SRP}} = -P_{SR@1AU}\frac{AU^2}{||\vec{r}_{sc-Sun}||^3}c_R\frac{A_{Sun}}{m}\vec{r}_{sc-Sun}
    \end{equation}
\end{itemize}

These forces give an acceleration to the spacecraft so that the total acceleration it perceives in orbit is
\begin{equation}
    \vec{a} = - \frac{\mu_{\oplus}}{r^3}\vec{r} + \vec{a}_{SRP} + \vec{a}_{J2}
\end{equation}

\section{Orbit Propagation}
\subsection{Methods}
% In Cartesian coordinates and Keplerian elements through Gauss’ planetary equations,
%comparison of the propagation methods in terms of accuracy, computational time etc.
To propagate the orbit we used two different methods:
\begin{itemize}
    \item \textbf{Gauss Planetary Equations}
    \par
    \begin{align*}
        \frac{da}{dt}&=\frac{2a^2}{h}\Big(e\sin f \: a_r +\frac{p}{r}a_s\Big)\\[1]
        \frac{de}{dt}&=\frac{1}{h}\Big(p\sin(f) \: a_r+ \Big( (p+r)\cos f +re \Big) a_s\Big)\\[1]
        \frac{di}{dt} &= \frac{r\cos(f+\omega)}{h}a_w\\[1]
        \frac{d\Omega}{dt}&=\frac{r\sin (f+\omega) }{h \sin i}a_w\\[1]
        \frac{d\omega}{dt}&=\frac{1}{he} \Big( \cos f \; a_r + (p+r)\sin f \; a_s \Big ) - \frac{r\sin(f+\omega)\cos i}{h\sin i} a_w\\[1]
        \frac{df}{dt} &= \frac{h}{r^2} + \frac{1}{eh} \Big(p \cos f \; a_r - (p+r)\sin f \; a_s 
    \end{align*}

    \par
    We numerically integrate these equations with the ode113 solver, by using them to set the derivatives of the state.
    The reference frame for this equations is the RSW frame so $a_r, a_s, a_w$ are respectively the  radial, transversal and out-of-plane components. \cite{RSW_Curtis} \cite{RSW_Vallado} \cite{RSW_Battin}
    
    \item \textbf{Numeric integration of cartesian equations}
    This method consists in directly integrating the Cartesian equations of motion
    \begin{equation}
        \vec{\ddot{r}} = - \frac{\mu_{\oplus}}{r^3}\vec{r} + \sum{a_{p}}
    \end{equation}
    
\end{itemize}

\subsection{Comparison}
\par

\begin{figure}[]
    \centering
    \includegraphics[width=1.5\textwidth]{400_T_error.eps}
    \caption{Evolution of the errors}
\end{figure}

\par
There are numerical error introducing differences between the two methods, but the error only grows up to an order of $10^{-5}$ for a propagation of 200 periods.


\section{History of the Keplerian elements}
% plot the history of every keplerian element
%% UPDATE THE PLOTS WITH 1YEAR ONES
\begin{figure}[H]
    \centering
    \includegraphics[width=\textwidth]{a.png}
    \caption{Evolution of the semi-major axis}
    \end{figure}

\begin{figure}[H]
    \centering
    \includegraphics[width=\textwidth]{e.png}
    \caption{Evolution of the eccentricity}
    \end{figure}


\begin{figure}[H]
    \centering
    \epsfig{file= 400_T.eps, width=\textwidth}
    \caption{Evolution of keplerian elements}
    \end{figure}

\section{Orbit evolution representation}

\section{HF filtering}
%Maybe we can do it when we plot the history of the Keplerian elements
For the filtering we have used the simple \emph{movmean} function integrated in MATLAB which computes the average at each time instant between the current point and the neighboring ones with a cutoff period of $3T_{orbit}$.

\par We can see in the \emph{secular evolution} that there is a superposition of effects from the J2 perturbation and the SRP:
\begin{itemize}
    \item \emph{$\dot{\Omega}$} : there is a \emph{nodal regression} due to the inclination $i$ being less than $90\degree$
    \item  \emph{$\dot{\omega}$} : there is a negative \emph{perigee precession} due to the inclination $i\;> 63.4\degree$ giving a so-called \emph{"Hula-hooping effect"}
    \item \emph{$\dot{e}$} : there are periodic oscillations with a slight secular decrease
\end{itemize}


\section{Comparison with real data}

\subsection{Satellite selection}

\subsection{Comparison with our model}

\begin{thebibliography}{9}
\bibitem{RSW_Curtis} 
Curtis, H.D. 
\textit{Orbital mechanics for engineering students}. 
Butterworth-Heinemann , 2014. Chapter 12

\bibitem{RSW_Vallado} 
Vallado, D.A.
\textit{Fundamental of Astrodynamics and Applications, 4th
Ed}, Microcosm Press, 2013. Chapters 8 and 9

\bibitem{RSW_Battin} 
Battin, R,
\textit{An Introduction to the Mathematics and Methods of
Astrodynamics}, AIAA Education Series, 1999. Chapter 10

\bibitem{SRP_Curtis} 
Curtis,H.D. 
\textit{Orbital mechanics for engineering students}. 
Butterworth-Heinemann , 2019. Chapter 10.9

\end{thebibliography}

\end{document}
